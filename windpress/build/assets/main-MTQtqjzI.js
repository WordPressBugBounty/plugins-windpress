import{_}from"./preload-helper-CsYsLKPR.min.js";import{l as j}from"./logger-BTW-zIW3.js";import{t as D,f as G}from"./tippy.esm-C2cIAwYP.min.js";import{n as y,H as z}from"./highlight-in-textarea-B9VLDWt4.js";import{T as H}from"./tribute.esm-DK9UGgwV.min.js";import{settingsState as C,brxGlobalProp as a,brxIframe as A,brxIframeGlobalProp as c}from"./constant-517WgKAG.js";import{d as W}from"./debounce-BB-8SLfJ.min.js";import{c as B,a as V}from"./index-jXUazPdk.min.js";import{W as k,n as p,w as N}from"./runtime-core.esm-bundler-Cyr_sIeO.min.js";import"./virtualRef-Dmg8xu3r.js";import"./index-BWcrFNHu.min.js";import"./isObject-K1YoVIH1.min.js";import"./set-Dt5k9sTt.min.js";import"./_toKey-BxB36GnB.min.js";import"./get-DBhW7rda.min.js";import"./index-BAMY2Nnw.min.js";import"./index-CgqXENQe.min.js";(async()=>{let $=null;(async()=>$=await B({themes:[_(()=>import("./dark-plus-C3mMm8J8.min.js"),[],import.meta.url),_(()=>import("./light-plus-B7mTdjB0.min.js"),[],import.meta.url)],langs:[_(()=>import("./css-DPfMkruS.min.js"),[],import.meta.url)],engine:V(_(()=>import("./wasm-CG6Dc4jp.min.js"),[],import.meta.url))}))();const l=document.createRange().createContextualFragment(`
    <textarea id="windpressbricks-plc-input" class="windpressbricks-plc-input" rows="2" spellcheck="false"></textarea>
`).querySelector("#windpressbricks-plc-input"),E=[],L=document.createRange().createContextualFragment(`
    <span id="windpressbricks-plc-class-sort" class="bricks-svg-wrapper windpressbricks-plc windpressbricks-plc-class-sort" data-balloon="Automatic Class Sorting" data-balloon-pos="left">
        <svg xmlns="http://www.w3.org/2000/svg" class="bricks-svg" viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round" class="bricks-svg icon icon-tabler icons-tabler-outline icon-tabler-reorder"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M17 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M5 11v-3a3 3 0 0 1 3 -3h8a3 3 0 0 1 3 3v3" /><path d="M16.5 8.5l2.5 2.5l2.5 -2.5" /></svg>    
    </span>
`).querySelector("#windpressbricks-plc-class-sort"),S=document.createRange().createContextualFragment(`
    <span id="windpressbricks-plc-class-down" class="bricks-svg-wrapper windpressbricks-plc windpressbricks-plc-class-down" data-balloon="Move Classes to Plain Classes" data-balloon-pos="left">
        <svg xmlns="http://www.w3.org/2000/svg" class="bricks-svg" width="32" height="32" viewBox="0 0 24 24"><!-- Icon from Lucide by Lucide Contributors - https://github.com/lucide-icons/lucide/blob/main/LICENSE --><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.5 13h6M2 16l4.5-9l4.5 9m7-9v9m-4-4l4 4l4-4"/></svg>    
    </span>
`).querySelector("#windpressbricks-plc-class-down");E.push(L),E.push(S);const M=k(!1),u=k([]),v=k(0);let I=null;y(l);let q=[];wp.hooks.addAction("windpressbricks-autocomplete-items-refresh","windpressbricks",()=>{q=wp.hooks.applyFilters("windpressbricks-autocomplete-items",[],l.value)}),wp.hooks.doAction("windpressbricks-autocomplete-items-refresh");const d=new H({containerClass:"windpressbricks-tribute-container",autocompleteMode:!0,menuItemLimit:50,noMatchTemplate:"",values:async function(e,s){if(!C("module.plain-classes.autocomplete",!0).value){s([]);return}const t=await wp.hooks.applyFilters("windpressbricks-autocomplete-items-query",q,e);s(t)},lookup:"value",itemClass:"class-item",menuItemTemplate:function(e){let s="";return e.original.color!==void 0&&(s+=`background-color: ${e.original.color};`),e.original.fontWeight!==void 0&&(s+=`font-weight: ${e.original.fontWeight};`),`
            <span class="class-name" data-tribute-class-name="${e.original.value}">${e.string}</span>
            <span class="class-hint" style="${s}"></span>
        `}});d.setMenuContainer=function(e){this.menuContainer=e};const P=d.events.callbacks;d.events.callbacks=function(){return{...P.call(this),up:(e,s)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let t=this.tribute.current.filteredItems.length,n=this.tribute.menuSelected;t>n&&n>0?(this.tribute.menuSelected--,this.setActiveLi()):n===0&&(this.tribute.menuSelected=t-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight),T()}},down:(e,s)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let t=this.tribute.current.filteredItems.length-1,n=this.tribute.menuSelected;t>n?(this.tribute.menuSelected++,this.setActiveLi()):t===n&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0),T()}}}},d.attach(l),new MutationObserver(function(e){e.forEach(function(s){s.type==="attributes"?s.target.id==="bricks-panel-element"&&s.attributeName==="style"&&(M.value=s.target.style.display!=="none"):s.type==="childList"&&s.addedNodes.length>0&&s.target.dataset&&s.target.dataset.controlkey==="_cssClasses"&&s.addedNodes[0].childNodes.length>0&&document.querySelector("#_cssClasses").addEventListener("input",function(t){p(()=>{l.value=t.target.value,h()})})})}).observe(document.getElementById("bricks-panel-element"),{subtree:!0,attributes:!0,childList:!0}),new MutationObserver(function(e){a.$_state.selectedElements.length>0?u.value=a.$_state.selectedElements.map(s=>s.id):a.$_activeElement.value?u.value=[a.$_activeElement.value.id]:u.value=[]}).observe(document.querySelector("#bricks-structure"),{subtree:!0,attributes:!0,childList:!0}),new MutationObserver(function(e){p(()=>{v.value===a.$_state.historyIndex&&(v.value=0),v.value=a.$_state.historyIndex})}).observe(document.querySelector("#bricks-toolbar > ul.group-wrapper.end > li.undo"),{subtree:!1,attributeFilter:["class"]}),N([u,M,v],(e,s)=>{(e[0]!==s[0]||e[2]!==s[2])&&p(()=>{if(e[0].length>0){const t=e[0].map(n=>{var i,r,o,f,w;return a.$_state.activeComponent?((o=(r=(i=a.$_state.components.find(m=>m.id===a.$_state.activeComponent.id))==null?void 0:i.elements.find(m=>m.id===n))==null?void 0:r.settings)==null?void 0:o._cssClasses)||"":((w=(f=a.$_state[a.$_state.templateType].find(m=>m.id===n))==null?void 0:f.settings)==null?void 0:w._cssClasses)||""});l.value=t.every(n=>n===t[0])?t[0]:""}else l.value="";h()}),e[0]&&e[1]&&p(()=>{const t=document.querySelector("#bricks-panel-sticky");if(C("module.plain-classes.input-field",!0).value&&t){if(t.querySelector(".windpressbricks-plc-input")===null){const i=document.createElement("div");i.style.padding="0 var(--builder-spacing)",i.appendChild(l),t.appendChild(i),I=new z(l,{highlight:[{highlight:new RegExp("(?<=\\s|^)(?:(?!\\s).)+(?=\\s|$)","g"),className:"word"},{highlight:new RegExp("(?<=\\s)\\s","g"),className:"multispace",blank:!0}]}),y.update(l)}const n=document.querySelector("#bricks-panel-element-classes > div > div.actions-wrapper > div > div.dropdown-wrapper > div");n.querySelectorAll(".windpressbricks-plc").length===0&&E.forEach(i=>{n.appendChild(i)})}})}),l.addEventListener("input",function(e){u.value.forEach(s=>{if(a.$_state.activeComponent){const t=a.$_state.components.find(n=>n.id===a.$_state.activeComponent.id);if(t){const n=t.elements.find(i=>i.id===s);n&&(n.settings._cssClasses=e.target.value)}}else{const t=a.$_state[a.$_state.templateType].find(n=>n.id===s);t&&(t.settings._cssClasses=e.target.value)}})});function h(){p(()=>{try{I.handleInput()}catch{}y.update(l),d.hideMenu()})}l.addEventListener("highlights-updated",function(e){F()});let b=D(document.createElement("div"),{plugins:[G],allowHTML:!0,arrow:!1,duration:[500,0],followCursor:!0,trigger:"manual"});function F(){const e=document.querySelector(".hit-container");if(e===null)return;b.reference=e;async function s(i){const r=i.textContent,o=await A.contentWindow.windpress.module.classnameToCss.generate(r);if(o===null||o.trim()==="")return null;b.setContent($.codeToHtml(o,{lang:"css",theme:"dark-plus"})),b.show()}const t=k(null),n=W(function(i){if(!C("module.plain-classes.hover-preview-classes",!0).value)return;const r=i.clientX,o=i.clientY,f=document.elementsFromPoint(r,o).find(w=>w.matches('mark[class="word"]'));t.value=f||null},10);e.addEventListener("mousemove",n),e.addEventListener("mouseleave",function(i){n.cancel(),t.value=null}),N(t,(i,r)=>{i&&i!==r?s(i):b.hide()})}const O=new MutationObserver(function(e){e.forEach(function(s){s.type==="childList"&&s.addedNodes.length>0&&s.addedNodes.forEach(t=>{const n=t.querySelector(".class-name").dataset.tributeClassName;t.addEventListener("mouseenter",i=>{R(n)}),t.addEventListener("mouseleave",i=>{x()}),t.addEventListener("click",i=>{x()})})})});let g=null;l.addEventListener("tribute-active-true",function(e){g===null&&(g=document.querySelector(".windpressbricks-tribute-container>ul")),p(()=>{g&&O.observe(g,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})})}),L.addEventListener("click",async function(e){l.value=await A.contentWindow.windpress.module.classSorter.sort(l.value),u.value.forEach(s=>{const t=a.$_state[a.$_state.templateType].find(n=>n.id===s);t&&(t.settings._cssClasses=e.target.value)}),h()}),S.addEventListener("click",async function(e){var n;const s=a.$_activeElement.value,t=l.value.split(" ");((n=s.settings)!=null&&n._cssGlobalClasses?[...s.settings._cssGlobalClasses]:[]).forEach(i=>{let r=a.$_getGlobalClassName(i);t.includes(r)||t.push(r)}),l.value=t.join(" "),a.$_activeElement.value.settings._cssClasses=l.value,a.$_activeElement.value.settings._cssGlobalClasses=[],h()});function R(e){c.$_getElementNode(c.$_activeElement.value).classList.add(e)}function x(){const e=c.$_activeElement.value,s=c.$_getElementNode(e),t=c.$_getElementClasses(e);s.classList.value=t.join(" ")}function T(){let e=d.menu.querySelector("li.highlight>span.class-name");const s=c.$_activeElement.value,t=c.$_getElementNode(s),n=c.$_getElementClasses(s);t.classList.value=n.join(" ")+" "+e.dataset.tributeClassName}j("Module loaded!",{module:"plain-classes"})})();
